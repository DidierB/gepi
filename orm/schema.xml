<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<database name="gepi" defaultIdMethod="native">

	<table name="utilisateurs" phpName="Utilisateur" description="Utilisateur de gepi">
		<column name="login" required="true" primaryKey="true" autoIncrement="false" type="VARCHAR" size="50" description="Login de l'utilisateur, et clé primaire de la table utilisateur" />
		<column name="nom" type="VARCHAR" required="true" size="50" description="Nom de l'utilisateur" />
		<column name="prenom" required="true" type="VARCHAR" size="50" description="Prenom de l'utilisateur" />
		<column name="civilite" required="true" type="VARCHAR" size="5" description="Civilite" />
		<column name="password" required="true" type="CHAR" size="32" description="Mot de passe" />
		<column name="email" required="true" type="VARCHAR" size="50" description="Email de l'utilisateur" />
		<column name="show_email" required="true" type="VARCHAR" size="50" default="no" description="L'email de l'utilisateur est-il public (yes/no)" />
		<column name="statut" required="true" type="VARCHAR" size="20" description="Statut de l'utilisateur" />
		<column name="etat" required="true" type="VARCHAR" size="20" description="Etat de l'utilisateur (actif/inactif)" />
		<column name="change_mdp" required="true" type="CHAR" size="1" default="n" description="L'utilisateur doit-il changer son mot de passe (y/n) (à la premiere connexion par exemple)" />
		<column name="date_verrouillage" required="true" type="TIME" default="2006-01-01 00:00:00" description="Date de verrouillage de l'utilisateur" />
		<column name="password_ticket" required="true" type="VARCHAR" size="255" description="password_ticket de l'utilisateur" />
		<column name="ticket_expiration" required="true" type="TIME" description="ticket_expiration de l'utilisateur" />
		<column name="niveau_alerte" required="true" type="SMALLINT" default="0" description="niveau_alerte de l'utilisateur" />
		<column name="observation_securite" required="true" type="TINYINT" default="0" description="observation_securite de l'utilisateur" />
		<column name="temp_dir" required="true" type="VARCHAR" size="255" description="Répertoire temporaire de l'utilisateur" />
		<column name="numind" required="true" type="VARCHAR" size="255" description="numind de l'utilisateur" />
		<column name="auth_mode" required="true" type="VARCHAR" size="255" default="gepi" description="auth_mode de l'utilisateur (gepi/cas/ldap)" />
	</table>

	<table name="ct_entry" phpName="CtCompteRendu" description="Compte rendu du cahier de texte">
		<column name="id_ct" required="true" primaryKey="true" autoIncrement="true" type="INTEGER" description="Cle primaire du compte rendu" />
		<column name="heure_entry" required="true" type="TIME" default="00:00:00" description="heure de l'entrée" />
		<column name="date_ct" required="true" type="INTEGER" default="0" description="date du compte rendu" />
		<column name="contenu" required="true" type="LONGVARCHAR" description="contenu redactionnel du compte rendu" />
		<column name="vise" required="true" type="CHAR" default="n" description="vise" />
		<column name="visa" required="true" type="CHAR" default="n" description="visa" />
		<column name="id_groupe" required="true" type="INTEGER" description="Cle etrangere du groupe auquel appartient le compte rendu" />
		<foreign-key foreignTable="groupes" onDelete="CASCADE">
			<reference local="id_groupe" foreign="id" />
		</foreign-key>
		<column name="id_login" required="true" type="VARCHAR" size="32" description="Cle etrangere de l'utilisateur auquel appartient le compte rendu" />
		<foreign-key foreignTable="utilisateurs" onDelete="CASCADE">
			<reference local="id_login" foreign="login" />
		</foreign-key>
	</table>

	<table name="ct_documents" phpName="CtDocument" description="Document (fichier joint) appartenant a un compte rendu du cahier de texte">
		<column name="id" required="true" primaryKey="true" autoIncrement="true" type="INTEGER" description="Cle primaire du document" />
		<column name="id_ct" default="0" required="true" type="INTEGER" description="Cle etrangere du compte rendu auquel appartient ce document" />
		<foreign-key foreignTable="ct_entry" onDelete="CASCADE"><reference local="id_ct" foreign="id_ct" /></foreign-key>
		<column name="titre" required="true" type="VARCHAR" size="255" description="Titre du document (fichier joint)" />
		<column name="taille" required="true" default="0" type="INTEGER" description="Taille du document (fichier joint)" />
		<column name="emplacement" required="true" type="VARCHAR" size="255" description="Chemin du système de fichier vers le document (fichier joint)" />
	</table>

	<table name="ct_devoirs_entry" phpName="CtTravailAFaire" description="Travail à faire (devoir) cahier de texte">
		<column name="id_ct" required="true" primaryKey="true" autoIncrement="true" type="INTEGER" description="Cle primaire du travail à faire" />
		<column name="date_ct" required="true" type="INTEGER" default="0" description="date pour laquelle le travail est a faire" />
		<column name="contenu" required="true" type="LONGVARCHAR" description="contenu redactionnel du travail a faire" />
		<column name="vise" required="true" type="CHAR" default="n" description="vise" />
		<column name="id_groupe" required="true" type="INTEGER" description="Cle etrangere du groupe auquel appartient ce travail a faire" />
		<foreign-key foreignTable="groupes" onDelete="CASCADE">
			<reference local="id_groupe" foreign="id" />
		</foreign-key>
		<column name="id_login" required="true" type="VARCHAR" size="32" description="Cle etrangere du l'utilisateur auquel appartient ce travail a faire" />
		<foreign-key foreignTable="utilisateurs" onDelete="CASCADE">
			<reference local="id_login" foreign="login" />
		</foreign-key>
	</table>

	<table name="ct_devoirs_documents" phpName="CtDevoirDocument" description="Document (fichier joint) appartenant a un travail à faire du cahier de texte">
		<column name="id" required="true" primaryKey="true" autoIncrement="true" type="INTEGER" description="Cle primaire du document" />
		<column name="id_ct_devoir" default="0" required="true" type="INTEGER" description="Cle etrangere du travail a faire auquel appartient ce document" />
		<foreign-key foreignTable="ct_devoirs_entry" onDelete="CASCADE"><reference local="id_ct_devoir" foreign="id_ct" /></foreign-key>
		<column name="titre" required="true" type="VARCHAR" size="255" description="Titre du document (fichier joint)" />
		<column name="taille" required="true" default="0" type="INTEGER" description="Taille du document (fichier joint)" />
		<column name="emplacement" required="true" type="VARCHAR" size="255" description="Chemin du système de fichier vers le document (fichier joint)" />
	</table>

	<table name="groupes" phpName="Groupe" description="Groupe d'eleves permettant d'y affecter des matieres et des professeurs">
		<column name="id" required="true" primaryKey="true" autoIncrement="true" type="INTEGER" description="Cle primaire du groupe" />
		<column name="name" required="true" type="VARCHAR" size="60" description="Nom du groupe" />
		<column name="description" required="true" type="LONGVARCHAR" description="Description du groupe" />
		<column name="recalcul_rang" type="VARCHAR" size="10" description="recalcul_rang" />
	</table>

	<table name="j_groupes_professeurs" description="Table permettant le jointure entre groupe d'eleves et professeurs. Est rarement utilisé directement dans le code.">
 		<column name="id_groupe" type="INTEGER" required="true" primaryKey="true" description="Cle primaire du groupe" />
 		<foreign-key foreignTable="groupes" onDelete="CASCADE"><reference local="id_groupe" foreign="id"/></foreign-key>
 		<column name="login" type="VARCHAR" size="50" required="true" primaryKey="true" description="Cle primaire de l'utilisateur" />
		<foreign-key foreignTable="utilisateurs" onDelete="CASCADE"><reference local="login" foreign="login"/></foreign-key>
	</table>

	<table name="classes" phpName="Classe" description="Classe regroupant des eleves">
		<column name="id" required="true" primaryKey="true" autoIncrement="true" type="INTEGER" description="Cle primaire de la classe" />
		<column name="classe" required="true" type="VARCHAR" size="100" description="nom de la classe" />
		<column name="nom_complet" required="true" type="VARCHAR" size="100" description="nom complet de la classe" />
		<column name="suivi_par" required="true" type="VARCHAR" size="50" />
		<column name="formule" required="true" type="VARCHAR" size="100" />
		<column name="format_nom" required="true" type="VARCHAR" size="5" />
		<column name="display_rang" required="true" type="CHAR" size="1" default="n"/>
		<column name="display_address" required="true" type="CHAR" size="1" default="n"/>
		<column name="display_coef" required="true" type="CHAR" size="1" default="y"/>
		<column name="display_mat_cat" required="true" type="CHAR" size="1" default="n"/>
		<column name="display_nbdev" required="true" type="CHAR" size="1" default="n"/>
		<column name="display_moy_gen" required="true" type="CHAR" size="1" default="y"/>
		<column name="modele_bulletin_pdf" type="VARCHAR" size="255" />
		<column name="rn_nomdev" required="true" type="CHAR"  default="n"/>
		<column name="rn_toutcoefdev" required="true" type="CHAR"  default="n"/>
		<column name="rn_coefdev_si_diff" required="true" type="CHAR" default="n"/>
		<column name="rn_datedev" required="true" type="CHAR" size="1" default="n"/>
		<column name="rn_sign_chefetab" required="true" type="CHAR" size="1" default="n"/>
		<column name="rn_sign_pp" required="true" type="CHAR" size="1" default="n"/>
		<column name="rn_sign_resp" required="true" type="CHAR" size="1" default="n"/>
		<column name="rn_sign_nblig" required="true" type="INTEGER" default="3"/>
		<column name="rn_formule" required="true" type="LONGVARCHAR"/>
	</table>

	<table name="j_groupes_classes" description="Table permettant le jointure entre groupe d'eleves et une classe. Est rarement utilisé directement dans le code.">
 		<column name="id_groupe" type="INTEGER" required="true" primaryKey="true" description="Cle primaire du groupe"/>
 		<foreign-key foreignTable="groupes" onDelete="CASCADE"><reference local="id_groupe" foreign="id"/></foreign-key>
 		<column name="id_classe" type="INTEGER" required="true" primaryKey="true" description="Cle primaire de la classe" />
		<foreign-key foreignTable="classes" onDelete="CASCADE"><reference local="id_classe" foreign="id"/></foreign-key>
 		<column name="priorite" type="SMALLINT" required="true"/>
 		<column name="coef" type="DECIMAL" required="true"/>
 		<column name="categorie_id" type="INTEGER" required="true"/>
	</table>

</database>
